"use strict";(self.webpackChunkcustomer_management_app=self.webpackChunkcustomer_management_app||[]).push([[474],{474:(B,f,i)=>{i.r(f),i.d(f,{CustomerModule:()=>R});var y=i(4908),u=i(2253),t=i(4946);let h=(()=>{class n{constructor(){}ngOnInit(){}static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["cm-orders"]],decls:27,vars:0,consts:[[1,"orders","view"],[1,"container"],[1,"glyphicon","glyphicon-user"],[1,"navbar"],[1,"nav","navbar-nav"],[1,"toolbar-item"],["routerLink","details","routerLinkActive","active"],[1,"glyphicon","glyphicon-list"],["routerLink","orders","routerLinkActive","active"],[1,"glyphicon","glyphicon-tags"],["routerLink","edit","routerLinkActive","active"],[1,"glyphicon","glyphicon-edit"],["routerLink","/customers"]],template:function(o,r){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"header")(3,"h3"),t._UZ(4,"span",2),t._uU(5,"\xa0\xa0Customer Information"),t.qZA()(),t._UZ(6,"br"),t.TgZ(7,"div",3)(8,"ul",4)(9,"li",5)(10,"a",6),t._UZ(11,"span",7),t._uU(12,"\xa0\xa0Customer Details "),t.qZA()(),t.TgZ(13,"li",5)(14,"a",8),t._UZ(15,"span",9),t._uU(16,"\xa0\xa0Customer Orders "),t.qZA()(),t.TgZ(17,"li",5)(18,"a",10),t._UZ(19,"span",11),t._uU(20,"\xa0\xa0Edit Customer "),t.qZA()()()(),t.TgZ(21,"div",1),t._UZ(22,"router-outlet")(23,"br")(24,"br"),t.TgZ(25,"a",12),t._uU(26,"View all Customers"),t.qZA()()()())},dependencies:[u.lC,u.rH,u.Od],encapsulation:2})}return n})();var p=i(7545),l=i(6814),_=i(8630);function x(n,c){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",6),t._uU(4),t.ALo(5,"currency"),t.qZA()()),2&n){const e=c.$implicit;t.xp6(2),t.Oqu(e.productName),t.xp6(2),t.Oqu(t.Dn7(5,2,e.itemCost,"USD","symbol"))}}function U(n,c){if(1&n&&(t.TgZ(0,"div",2)(1,"h4"),t._uU(2),t.ALo(3,"capitalize"),t.ALo(4,"capitalize"),t.qZA(),t._UZ(5,"br"),t.TgZ(6,"table",3),t.YNc(7,x,6,6,"tr",4),t.TgZ(8,"tr",5)(9,"td"),t._uU(10,"\xa0"),t.qZA(),t.TgZ(11,"td",6),t._uU(12),t.ALo(13,"currency"),t.qZA()()()()),2&n){const e=t.oxw();t.xp6(2),t.AsE("Orders for ",t.lcZ(3,5,e.customer.firstName)," ",t.lcZ(4,7,e.customer.lastName),""),t.xp6(5),t.Q6J("ngForOf",e.customer.orders)("ngForTrackBy",e.ordersTrackBy),t.xp6(5),t.Oqu(t.Dn7(13,9,e.customer.orderTotal,"USD","symbol"))}}function N(n,c){1&n&&(t.TgZ(0,"div",2),t._uU(1," No orders found "),t.qZA())}function O(n,c){1&n&&(t.TgZ(0,"div",2),t._uU(1," No customer found "),t.qZA())}let v=(()=>{class n{constructor(e,o){this.route=e,this.dataService=o,this.orders=[],this.customer={}}ngOnInit(){this.route.parent?.params.subscribe(e=>{this.dataService.getCustomer(+e.id).subscribe(r=>{this.customer=r})})}ordersTrackBy(e,o){return e}static#t=this.\u0275fac=function(o){return new(o||n)(t.Y36(u.gz),t.Y36(p.D))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["cm-customer-orders"]],decls:4,vars:3,consts:[[1,"container"],["class","row",4,"ngIf"],[1,"row"],[1,"table","table-striped","table-hover","orders-table"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"summary-border"],[1,"text-right"]],template:function(o,r){1&o&&(t.TgZ(0,"div",0),t.YNc(1,U,14,13,"div",1),t.YNc(2,N,2,0,"div",1),t.YNc(3,O,2,0,"div",1),t.qZA()),2&o&&(t.xp6(1),t.Q6J("ngIf",r.customer&&r.customer.orders),t.xp6(1),t.Q6J("ngIf",r.customer&&!r.customer.orders),t.xp6(1),t.Q6J("ngIf",!r.customer))},dependencies:[l.sg,l.O5,l.H9,_.e],encapsulation:2})}return n})();var q=i(5861);const J=["mapsContainer"];function F(n,c){if(1&n&&(t.TgZ(0,"div",2)(1,"div",6),t._UZ(2,"img",7),t.ALo(3,"lowercase"),t.qZA(),t.TgZ(4,"div",8)(5,"h4"),t._uU(6),t.ALo(7,"capitalize"),t.ALo(8,"capitalize"),t.qZA(),t._UZ(9,"br"),t._uU(10),t._UZ(11,"br"),t._uU(12),t.qZA()()),2&n){const e=t.oxw();t.xp6(2),t.MGl("src","assets/images/",t.lcZ(3,6,e.customer.gender),".png",t.LSH),t.xp6(4),t.AsE(" ",t.lcZ(7,8,e.customer.firstName)," ",t.lcZ(8,10,e.customer.lastName),"\xa0 "),t.xp6(4),t.hij(" ",e.customer.address," "),t.xp6(2),t.AsE(" ",e.customer.city,", ",e.customer.state.name," ")}}function E(n,c){1&n&&(t.TgZ(0,"div",0),t._uU(1," No customer found\n"),t.qZA())}let C=(()=>{class n{constructor(e,o,r){this.route=e,this.dataService=o,this.componentFactoryResolver=r,this.customer=null,this.mapEnabled=!1,this.mapComponentRef={},this.mapsViewContainerRef={}}ngOnInit(){this.route.parent?.params.subscribe(e=>{const o=+e.id;o&&this.dataService.getCustomer(o).subscribe(r=>{this.customer=r,this.customer&&this.customer.latitude&&this.lazyLoadMapComponent()})})}lazyLoadMapComponent(){var e=this;return(0,q.Z)(function*(){if(!e.mapsViewContainerRef.length){const{MapComponent:o}=yield i.e(697).then(i.bind(i,1697));console.log("Lazy loaded map component for customer!"),e.mapComponentRef=e.mapsViewContainerRef.createComponent(o),e.mapComponentRef.instance.zoom=10,e.mapComponentRef.instance.customer=e.customer,e.mapComponentRef.instance.enabled=!0}})()}static#t=this.\u0275fac=function(o){return new(o||n)(t.Y36(u.gz),t.Y36(p.D),t.Y36(t._Vd))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["cm-customer-details"]],viewQuery:function(o,r){if(1&o&&t.Gf(J,5,t.s_b),2&o){let s;t.iGM(s=t.CRH())&&(r.mapsViewContainerRef=s.first)}},decls:10,vars:2,consts:[[1,"container"],["class","row",4,"ngIf"],[1,"row"],[1,"col-md-12"],["mapsContainer",""],["class","container",4,"ngIf"],[1,"col-md-2"],["title","customer picture",1,"details-image",3,"src"],[1,"col-md-10"]],template:function(o,r){1&o&&(t.TgZ(0,"div",0),t.YNc(1,F,13,12,"div",1),t._UZ(2,"br")(3,"br"),t.TgZ(4,"div",2)(5,"div",3)(6,"div"),t.GkF(7,null,4),t.qZA()()()(),t.YNc(9,E,2,0,"div",5)),2&o&&(t.xp6(1),t.Q6J("ngIf",r.customer),t.xp6(8),t.Q6J("ngIf",!r.customer))},dependencies:[l.O5,l.i8,_.e],styles:[".details-image[_ngcontent-%COMP%]{height:100px;width:100px;margin-top:10px}"]})}return n})();var d=i(9305),w=i(2639),Z=i(5996),m=i(95);const Y=["customerForm"];function Q(n,c){if(1&n&&(t.TgZ(0,"option",16),t._uU(1),t.qZA()),2&n){const e=c.$implicit;t.Q6J("ngValue",e.abbreviation),t.xp6(1),t.Oqu(e.name)}}function L(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"div",20),t._uU(1," Delete Customer?\xa0\xa0"),t.TgZ(2,"button",21),t.NdJ("click",function(r){t.CHM(e);const s=t.oxw(2);return t.KtG(s.delete(r))}),t._uU(3,"Yes"),t.qZA(),t._uU(4,"\xa0\xa0 "),t.TgZ(5,"button",22),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.deleteMessageEnabled=!1)}),t._uU(6,"No"),t.qZA()()}}function I(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"button",21),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.deleteMessageEnabled=!0)}),t._uU(1,"Delete"),t.qZA()}}function S(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"div",23)(1,"button",22),t.NdJ("click",function(r){t.CHM(e);const s=t.oxw(2);return t.KtG(s.cancel(r))}),t._uU(2,"Cancel"),t.qZA(),t._uU(3,"\xa0\xa0 "),t.TgZ(4,"button",24),t._uU(5),t.qZA()()}if(2&n){const e=t.oxw(2),o=t.MAs(2);t.xp6(4),t.Q6J("disabled",o.pristine||!o.valid),t.xp6(1),t.Oqu(e.operationText)}}function D(n,c){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,L,7,0,"div",17),t.YNc(2,I,2,0,"button",18),t._uU(3,"\xa0\xa0 "),t.YNc(4,S,6,2,"div",19),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.customer.id&&e.deleteMessageEnabled),t.xp6(1),t.Q6J("ngIf",e.customer.id&&!e.deleteMessageEnabled),t.xp6(2),t.Q6J("ngIf",!e.deleteMessageEnabled)}}function k(n,c){if(1&n&&(t.TgZ(0,"div",25),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Oqu(e.errorMessage)}}let A=(()=>{class n{constructor(e,o,r,s,a,g){this.router=e,this.route=o,this.dataService=r,this.growler=s,this.modalService=a,this.logger=g,this.customer={id:0,firstName:"",lastName:"",gender:"",address:"",city:"",state:{abbreviation:"",name:""}},this.states=[],this.errorMessage="",this.deleteMessageEnabled=!1,this.operationText="Insert",this.customerForm={}}ngOnInit(){this.route.parent?.params.subscribe(e=>{const o=+e.id;0!==o&&(this.operationText="Update",this.getCustomer(o))}),this.dataService.getStates().subscribe(e=>this.states=e)}getCustomer(e){this.dataService.getCustomer(e).subscribe(o=>{this.customer=o})}submit(){0===this.customer.id?this.dataService.insertCustomer(this.customer).subscribe(e=>{if(e)this.customerForm.form.markAsPristine(),this.router.navigate(["/customers"]);else{const o="Unable to insert customer";this.growler.growl(o,d.h.Danger),this.errorMessage=o}},e=>this.logger.log(e)):this.dataService.updateCustomer(this.customer).subscribe(e=>{if(e)this.customerForm.form.markAsPristine(),this.growler.growl("Operation performed successfully.",d.h.Success);else{const o="Unable to update customer";this.growler.growl(o,d.h.Danger),this.errorMessage=o}},e=>this.logger.log(e))}cancel(e){e.preventDefault(),this.router.navigate(["/customers"])}delete(e){e.preventDefault(),this.dataService.deleteCustomer(this.customer.id).subscribe(o=>{o?this.router.navigate(["/customers"]):this.errorMessage="Unable to delete customer"},o=>this.logger.log(o))}canDeactivate(){return!this.customerForm.dirty||this.modalService.show({header:"Lose Unsaved Changes?",body:"You have unsaved changes! Would you like to leave the page and lose them?",cancelButtonText:"Cancel",OKButtonText:"Leave"})}static#t=this.\u0275fac=function(o){return new(o||n)(t.Y36(u.F0),t.Y36(u.gz),t.Y36(p.D),t.Y36(d.n),t.Y36(w.Z),t.Y36(Z.m))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["cm-customer-edit"]],viewQuery:function(o,r){if(1&o&&t.Gf(Y,7),2&o){let s;t.iGM(s=t.CRH())&&(r.customerForm=s.first)}},decls:39,vars:12,consts:[["novalidate","",1,"customer-form",3,"ngSubmit"],["customerForm","ngForm"],[1,"form-group"],["title","first name","type","text","name","firstName","required","",1,"form-control",3,"ngModel","ngModelChange"],["firstName","ngModel"],[1,"alert","alert-danger",3,"hidden"],["title","last name","type","text","name","lastName","required","",1,"form-control",3,"ngModel","ngModelChange"],["lastName","ngModel"],["title","address","type","text","name","address","required","",1,"form-control",3,"ngModel","ngModelChange"],["address","ngModel"],["title","city","type","text","name","city","required","",1,"form-control",3,"ngModel","ngModelChange"],["city","ngModel"],["title","states","name","state","required","",1,"form-control",3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[3,"ngValue"],["class","alert alert-warning",4,"ngIf"],["class","btn btn-danger",3,"click",4,"ngIf"],["class","pull-right",4,"ngIf"],[1,"alert","alert-warning"],[1,"btn","btn-danger",3,"click"],[1,"btn","btn-default",3,"click"],[1,"pull-right"],["type","submit",1,"btn","btn-success",3,"disabled"],[1,"alert","alert-danger"]],template:function(o,r){if(1&o&&(t.TgZ(0,"div")(1,"form",0,1),t.NdJ("ngSubmit",function(){return r.submit()}),t.TgZ(3,"div",2)(4,"label"),t._uU(5,"First Name"),t.qZA(),t.TgZ(6,"input",3,4),t.NdJ("ngModelChange",function(a){return r.customer.firstName=a}),t.qZA(),t.TgZ(8,"div",5),t._uU(9,"First Name is required"),t.qZA()(),t.TgZ(10,"div",2)(11,"label"),t._uU(12,"Last Name"),t.qZA(),t.TgZ(13,"input",6,7),t.NdJ("ngModelChange",function(a){return r.customer.lastName=a}),t.qZA(),t.TgZ(15,"div",5),t._uU(16,"Last Name is required"),t.qZA()(),t.TgZ(17,"div",2)(18,"label"),t._uU(19,"Address"),t.qZA(),t.TgZ(20,"input",8,9),t.NdJ("ngModelChange",function(a){return r.customer.address=a}),t.qZA(),t.TgZ(22,"div",5),t._uU(23,"Address is required"),t.qZA()(),t.TgZ(24,"div",2)(25,"label"),t._uU(26,"City"),t.qZA(),t.TgZ(27,"input",10,11),t.NdJ("ngModelChange",function(a){return r.customer.city=a}),t.qZA(),t.TgZ(29,"div",5),t._uU(30,"City is required"),t.qZA()(),t.TgZ(31,"div",2)(32,"label"),t._uU(33,"State"),t.qZA(),t.TgZ(34,"select",12),t.NdJ("ngModelChange",function(a){return r.customer.state.abbreviation=a}),t.YNc(35,Q,2,2,"option",13),t.qZA()(),t.YNc(36,D,5,3,"div",14),t.YNc(37,k,2,1,"div",15),t.qZA(),t._UZ(38,"br"),t.qZA()),2&o){const s=t.MAs(7),a=t.MAs(14),g=t.MAs(21),M=t.MAs(28);t.xp6(6),t.Q6J("ngModel",r.customer.firstName),t.xp6(2),t.Q6J("hidden",s.pristine||s.valid),t.xp6(5),t.Q6J("ngModel",r.customer.lastName),t.xp6(2),t.Q6J("hidden",a.pristine||a.valid),t.xp6(5),t.Q6J("ngModel",r.customer.address),t.xp6(2),t.Q6J("hidden",g.pristine||g.valid),t.xp6(5),t.Q6J("ngModel",r.customer.city),t.xp6(2),t.Q6J("hidden",M.pristine||M.valid),t.xp6(5),t.Q6J("ngModel",r.customer.state.abbreviation),t.xp6(1),t.Q6J("ngForOf",r.states),t.xp6(1),t.Q6J("ngIf",r.customer),t.xp6(1),t.Q6J("ngIf",r.errorMessage)}},dependencies:[l.sg,l.O5,m._Y,m.YN,m.Kr,m.Fj,m.EJ,m.JJ,m.JL,m.Q7,m.On,m.F],styles:[".customer-form[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .customer-form[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%], .customer-form[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%], .customer-form[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%}.customer-form[_ngcontent-%COMP%]   .ng-invalid[_ngcontent-%COMP%]{border-left:5px solid #a94442}.customer-form[_ngcontent-%COMP%]   .ng-valid[_ngcontent-%COMP%]{border-left:5px solid #42A948}"]})}return n})();var z=i(304);let b=(()=>{class n{constructor(e,o){this.authService=e,this.router=o}canActivate(e,o){return!!this.authService.isAuthenticated||(this.authService.redirectUrl=o.url,this.router.navigate(["/login"]),!1)}static#t=this.\u0275fac=function(o){return new(o||n)(t.LFG(z.e),t.LFG(u.F0))};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac})}return n})(),T=(()=>{class n{constructor(e){this.logger=e}canDeactivate(e,o,r){return this.logger.log(`CustomerId: ${o.parent?.params.id} URL: ${r.url}`),e.canDeactivate()}static#t=this.\u0275fac=function(o){return new(o||n)(t.LFG(Z.m))};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac})}return n})();const P=[{path:"",component:h,children:[{path:"orders",component:v},{path:"details",component:C},{path:"edit",component:A,canActivate:[b],canDeactivate:[T]}]}];let G=(()=>{class n{static#t=this.components=[h,v,C,A];static#e=this.\u0275fac=function(o){return new(o||n)};static#o=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({providers:[b,T],imports:[u.Bz.forChild(P),u.Bz]})}return n})(),R=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275mod=t.oAB({type:n});static#o=this.\u0275inj=t.cJS({imports:[G,y.m]})}return n})()}}]);